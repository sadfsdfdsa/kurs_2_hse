(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b4e26f2"],{1976:function(t,e,s){"use strict";s("5fc3")},3530:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",[s("nav-bar",{attrs:{label:"Administration","show-logout":""}}),s("div",{staticClass:"column q-px-xl"},[s("div",{staticClass:"row text-h4 items-center"},[s("div",{staticClass:"col"},[t._v(" Сотрудники "),s("q-btn",{staticClass:"q-mr-sm",attrs:{color:"orange-10",icon:"fas fa-chevron-"+(t.showUsers?"up":"down"),size:"md",flat:""},on:{click:function(e){t.showUsers=!t.showUsers}}}),s("q-btn",{staticClass:"q-ml-md",attrs:{icon:"fa fa-plus",color:"blue-9",outline:""},on:{click:t.createUser}})],1)]),t.showUsers?s("div",{staticClass:"row"},[s("q-input",{staticClass:"col-5",attrs:{placeholder:"Поиск сотрудника"},model:{value:t.findUser,callback:function(e){t.findUser=e},expression:"findUser"}})],1):t._e(),t.showUsers?s("div",{staticClass:"row column q-mt-md"},t._l(t.users,(function(e,o){return s("div",{key:o,staticClass:"row text-h6 shadow-1 q-mb-md q-pa-sm hse-rounded"},[s("div",{staticClass:"col"},[t._v(" "+t._s(o+1+". "+t.getName(e))+" ")]),s("div",{staticClass:"col-auto q-mr-sm"},[s("q-btn",{staticClass:"q-ml-md",attrs:{icon:"fa fa-edit",color:"orange-9",outline:"",flat:""},on:{click:function(s){return t.editUser(e)}}})],1)])})),0):t._e(),s("div",{staticClass:"row text-h4 q-mt-lg items-center"},[s("div",{staticClass:"col"},[t._v(" Работы "),s("q-btn",{staticClass:"q-mr-sm",attrs:{color:"orange-10",icon:"fas fa-chevron-"+(t.showWorks?"up":"down"),size:"md",flat:""},on:{click:function(e){t.showWorks=!t.showWorks}}}),s("q-btn",{staticClass:"q-ml-md",attrs:{icon:"fa fa-plus",color:"blue-9",outline:""},on:{click:t.createWork}})],1)]),t.showWorks?s("div",{staticClass:"row"},[s("q-input",{staticClass:"col-5",attrs:{placeholder:"Поиск работ"},model:{value:t.findWork,callback:function(e){t.findWork=e},expression:"findWork"}}),s("div",{staticClass:"col"},[s("q-btn",{attrs:{color:"blue-9",outline:"all"!==t.nowWorkKind,unelevated:""},on:{click:function(e){t.nowWorkKind="all"}}},[t._v(" Все ")]),s("q-btn",{attrs:{color:"green-9",outline:"archive"!==t.nowWorkKind,unelevated:""},on:{click:function(e){t.nowWorkKind="archive"}}},[t._v(" Архивные ")]),s("q-btn",{attrs:{color:"orange-9",outline:"active"!==t.nowWorkKind,unelevated:""},on:{click:function(e){t.nowWorkKind="active"}}},[t._v(" Активные ")])],1)],1):t._e(),t.showWorks?s("div",{staticClass:"row column q-mt-md"},t._l(t.works,(function(e,o){return s("div",{key:o,staticClass:"row items-center q-mb-md q-pa-md shadow-1 hse-rounded"},[s("div",{staticClass:"col-5 text-h6 ellipsis"},[t._v(" "+t._s(o+1+". "+e.name)+" ")]),s("div",{staticClass:"col-7 text-body1 ellipsis"},[t._v(" Руководитель: "),s("span",{staticClass:"text-bold"},[t._v(t._s(t.usernameById(e.creatorId)))])]),s("div",{staticClass:"col-4 q-mt-sm"},[t._v(" Дедлайн: "),s("span",{staticClass:"text-bold"},[t._v(t._s(t.formatDeadline(e.deadline)))])]),s("div",{staticClass:"col-4 q-mt-sm"},[t._v(" Создана: "),s("span",{staticClass:"text-bold"},[t._v(t._s(t.formatDeadline(e.created)))])]),s("div",{staticClass:"col-3 q-mt-sm"},[t._v(" Статус: "),s("span",{staticClass:"text-bold",class:"Завершена"===e.status?"text-green-9":"text-orange-9"},[t._v(t._s(e.status))])]),s("div",{staticClass:"col-1 q-mt-sm"},[t._v(" Оценка: "),s("span",{staticClass:"text-bold"},[t._v(t._s(t.formatScore(e.totalScore)||"Нет"))])]),s("div",{staticClass:"col-4 q-mt-sm"},[s("q-btn",{attrs:{color:"blue-9",outline:""},on:{click:function(s){return t.$router.push({name:"TaskInfo",params:{id:e.id}})}}},[t._v(" Смотреть ")])],1),"Завершена"!==e.status?s("div",{staticClass:"col-4 q-mt-sm"},[s("q-btn",{attrs:{color:"orange-9",outline:""},on:{click:function(s){return t.editWork(e)}}},[t._v(" Редактировать ")])],1):t._e(),"Завершена"!==e.status?s("div",{staticClass:"col-4 q-mt-sm"},[s("q-btn",{attrs:{color:"red-9",outline:""},on:{click:function(s){return t.archiveWork(e)}}},[t._v(" В архив ")])],1):t._e()])})),0):t._e()]),s("q-dialog",{model:{value:t.taskDialog,callback:function(e){t.taskDialog=e},expression:"taskDialog"}},[s("q-card",{staticClass:"q-pa-lg",staticStyle:{"min-width":"50vw !important"}},[s("q-card-section",[s("q-input",{staticClass:"text-h6",attrs:{placeholder:"Название работы"},model:{value:t.taskForm.workName,callback:function(e){t.$set(t.taskForm,"workName",e)},expression:"taskForm.workName"}})],1),s("q-card-section",[s("q-input",{staticClass:"text-body1",attrs:{placeholder:"Комментарий к работе",type:"textarea",autogrow:""},model:{value:t.taskForm.workComment,callback:function(e){t.$set(t.taskForm,"workComment",e)},expression:"taskForm.workComment"}})],1),s("q-card-section",[s("q-select",{attrs:{options:t.workersPicker,label:"Научный руководитель","stack-label":"","map-options":"","emit-value":""},model:{value:t.taskForm.selectWorker,callback:function(e){t.$set(t.taskForm,"selectWorker",e)},expression:"taskForm.selectWorker"}})],1),"new"===t.formType?s("q-card-section",[s("q-select",{attrs:{options:t.workersPicker,label:"Проверяющие","use-chips":"","stack-label":"",multiple:"","map-options":"","emit-value":""},model:{value:t.taskForm.selectWorkers,callback:function(e){t.$set(t.taskForm,"selectWorkers",e)},expression:"taskForm.selectWorkers"}})],1):t._e(),s("q-card-section",[s("div",{staticClass:"row"},[s("div",{staticClass:"col-auto"},[s("q-input",{attrs:{label:"Оценка научного руководителя",type:"number",rules:[function(t){return t<=10&&t>=0||"Number from 0 to 10"}]},model:{value:t.taskForm.score,callback:function(e){t.$set(t.taskForm,"score",t._n(e))},expression:"taskForm.score"}})],1),s("div",{staticClass:"col-auto q-ml-sm"},[s("q-input",{attrs:{label:"Оценка рецензента",type:"number",rules:[function(t){return t<=10&&t>=0||"Number from 0 to 10"}]},model:{value:t.taskForm.reviewScore,callback:function(e){t.$set(t.taskForm,"reviewScore",t._n(e))},expression:"taskForm.reviewScore"}})],1)])]),s("q-card-section",{staticClass:"q-pt-none"},[s("q-btn",{attrs:{color:"primary",label:"Крайний срок: "+(t.formatDeadline(t.taskForm.deadline)||"Без ограничения")}},[s("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[s("q-date",{attrs:{minimal:"",options:t.validateDate},model:{value:t.taskForm.deadline,callback:function(e){t.$set(t.taskForm,"deadline",e)},expression:"taskForm.deadline"}})],1)],1)],1),s("q-card-section",{staticClass:"q-pt-none"},[t._v(" Ссылка на работу: "),s("q-input",{staticClass:"text-h6",attrs:{placeholder:"https://onedrive.com/mygoodwork"},model:{value:t.taskForm.workLink,callback:function(e){t.$set(t.taskForm,"workLink",e)},expression:"taskForm.workLink"}})],1),s("q-card-section",{staticClass:"q-pt-none"},[t._v(" Ссылка на нормативные документы (необязательно): "),s("q-input",{staticClass:"text-h6",attrs:{placeholder:"https://onedrive.com/mygooddoc.pdf"},model:{value:t.taskForm.documentLink,callback:function(e){t.$set(t.taskForm,"documentLink",e)},expression:"taskForm.documentLink"}})],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{attrs:{flat:"",label:"Подтвердить",color:"blue-9"},on:{click:t.saveWork}})],1)],1)],1),s("q-dialog",{model:{value:t.userDialog,callback:function(e){t.userDialog=e},expression:"userDialog"}},[s("q-card",{staticClass:"q-pa-lg",staticStyle:{"min-width":"50vw !important"}},[s("q-card-section",{staticClass:"text-h5"},[t._v(" Пользователь: "+t._s("edit"===t.formType?"редактирование":"создание")+" ")]),s("q-card-section",[s("q-input",{staticClass:"text-h6",attrs:{placeholder:"Фамилия"},model:{value:t.userForm.secondName,callback:function(e){t.$set(t.userForm,"secondName",e)},expression:"userForm.secondName"}})],1),s("q-card-section",[s("q-input",{staticClass:"text-h6",attrs:{placeholder:"Имя"},model:{value:t.userForm.firstName,callback:function(e){t.$set(t.userForm,"firstName",e)},expression:"userForm.firstName"}})],1),s("q-card-section",[s("q-input",{staticClass:"text-h6",attrs:{placeholder:"Отчество"},model:{value:t.userForm.middleName,callback:function(e){t.$set(t.userForm,"middleName",e)},expression:"userForm.middleName"}})],1),"new"===t.formType?s("q-card-section",[s("q-input",{staticClass:"text-h6",attrs:{placeholder:"Логин"},model:{value:t.userForm.login,callback:function(e){t.$set(t.userForm,"login",e)},expression:"userForm.login"}})],1):t._e(),"new"===t.formType?s("q-card-section",[s("q-input",{staticClass:"text-h6",attrs:{placeholder:"Пароль",type:"password"},model:{value:t.userForm.password,callback:function(e){t.$set(t.userForm,"password",e)},expression:"userForm.password"}})],1):t._e(),"new"===t.formType?s("q-card-section",[s("div",{staticClass:"text-body1 text-grey-10"},[t._v(" Длина логина и пароля - от 4 символов ")])]):t._e(),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{attrs:{flat:"",label:"Подтвердить",color:"blue-9"},on:{click:t.saveUser}})],1)],1)],1)],1)},r=[],a=(s("4de4"),s("4160"),s("caad"),s("d81d"),s("b0c0"),s("a9e3"),s("b680"),s("d3b7"),s("2532"),s("159b"),s("2b0e")),i=s("79f6"),n=a["a"].extend({components:{NavBar:function(){return s.e("chunk-cba988a0").then(s.bind(null,"4461"))}},data:function(){return{findWork:"",findUser:"",showWorks:!0,showUsers:!0,nowWorkKind:"all",formType:"new",formId:0,taskDialog:!1,taskForm:{workName:"",workComment:"",selectWorker:null,selectWorkers:[],score:0,reviewScore:0,deadline:new Date,workLink:"",documentLink:""},userDialog:!1,userForm:{firstName:"",secondName:"",middleName:"",login:"",password:""}}},computed:{works:function(){var t=this,e=this.$store.getters.allWorks;return e=e.filter((function(e){return e.name.toLowerCase().includes(t.findWork.toLowerCase())})),e=e.sort((function(t,e){return e.created.getTime()-t.created.getTime()})),"archive"===this.nowWorkKind?e.filter((function(t){return-1!==t.totalScore})):"active"===this.nowWorkKind?e.filter((function(t){return-1===t.totalScore})):e},users:function(){var t=this,e=this.$store.getters.users;return e.filter((function(e){return t.getName(e).toLowerCase().includes(t.findUser.toLowerCase())}))},workersPicker:function(){var t=this,e=[];return this.$store.getters.users.forEach((function(s){return e.push({label:t.$store.getters.shortName(s),value:s})})),e}},created:function(){this.$store.dispatch("loadUsers"),this.$store.dispatch("loadAllWorks")},methods:{validateDate:function(t){return new Date(t)>new Date},getName:function(t){return t?t.secondName+" "+t.firstName+" "+t.middleName:""},formatDeadline:function(t){if(!t)return"Нет";var e={year:"numeric",month:"long",day:"numeric"};return new Date(t).toLocaleDateString("ru-RU",e)},formatScore:function(t){return-1===t?"":t.toFixed(1)},usernameById:function(t){return this.getName(this.$store.getters.user(t))},editUser:function(t){this.userDialog=!0,this.formType="edit",this.formId=t.id,this.userForm.firstName=t.firstName,this.userForm.secondName=t.secondName,this.userForm.middleName=t.middleName},editWork:function(t){this.taskDialog=!0,this.formType="edit",this.formId=t.id,this.taskForm.workName=t.name,this.taskForm.workComment=t.comment,this.taskForm.selectWorker=this.$store.getters.user(t.creatorId),this.taskForm.score=t.directorScore,this.taskForm.reviewScore=t.reviewerScore,this.taskForm.deadline=t.deadline?new Date(t.deadline):null,this.taskForm.workLink=t.workLink,this.taskForm.documentLink=t.documentLink},archiveWork:function(t){try{i["b"].archiveWork(t.id),this.$store.dispatch("loadAllWorks")}catch(e){window.alert("Произошла ошибка:"+e.toRaw())}},createUser:function(){this.userDialog=!0,this.formType="new",this.userForm={firstName:"",secondName:"",middleName:"",login:"",password:""}},createWork:function(){this.taskDialog=!0,this.formType="new",this.taskForm={workName:"",workComment:"",selectWorker:null,selectWorkers:[],score:0,reviewScore:0,deadline:null,workLink:"",documentLink:""}},saveUser:function(){"new"===this.formType?i["a"].createUser(this.userForm):i["a"].editUser(this.formId,this.userForm),this.$store.dispatch("loadUsers"),this.userDialog=!1},saveWork:function(){if("new"===this.formType){var t={creatorId:this.taskForm.selectWorker.id||0,name:this.taskForm.workName,workLink:this.taskForm.workLink,documentLink:this.taskForm.documentLink,deadline:this.taskForm.deadline?new Date(this.taskForm.deadline).getTime():0,directorScore:this.taskForm.score,reviewerScore:this.taskForm.reviewScore,comment:this.taskForm.workComment,workers:this.taskForm.selectWorkers.map((function(t){return Number(t.id)})),created:(new Date).getTime()};i["b"].create(t)}else{var e={creatorId:this.taskForm.selectWorker.id||0,name:this.taskForm.workName,workLink:this.taskForm.workLink,documentLink:this.taskForm.documentLink,deadline:this.taskForm.deadline?new Date(this.taskForm.deadline).getTime():0,directorScore:this.taskForm.score,reviewerScore:this.taskForm.reviewScore,comment:this.taskForm.workComment};i["b"].editWork(this.formId,e)}this.$store.dispatch("loadAllWorks"),this.taskDialog=!1}}}),c=n,l=(s("1976"),s("2877")),m=s("9989"),d=s("9c40"),u=s("27f9"),k=s("24e8"),h=s("f09f"),f=s("a370"),p=s("ddd8"),w=s("7cbe"),v=s("52ee"),b=s("4b7e"),q=s("93dc"),F=s.n(q),C=Object(l["a"])(c,o,r,!1,null,"7977970e",null);e["default"]=C.exports;F()(C,"components",{QPage:m["a"],QBtn:d["a"],QInput:u["a"],QDialog:k["a"],QCard:h["a"],QCardSection:f["a"],QSelect:p["a"],QPopupProxy:w["a"],QDate:v["a"],QCardActions:b["a"]})},"5fc3":function(t,e,s){}}]);